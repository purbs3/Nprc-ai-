import{r as l,j as e,g as C}from"./index-DIzydVhA.js";import{b as S,c as P,d as k,e as D}from"./forumService-26YnwC0u.js";import{R as M}from"./RichTextEditor-BrE2tSya.js";import{L as F}from"./LoadingSpinner-BQulzYF6.js";const $=({categorySlug:h,onNavigate:o})=>{const[n,p]=l.useState(null),[i,r]=l.useState([]),[j,u]=l.useState(!0),[c,d]=l.useState(!1),[m,g]=l.useState(""),[x,f]=l.useState("");l.useEffect(()=>{(async()=>{u(!0);const a=await C(),t=await S(h);if(t){p(t),document.title=`${t.name} - ${a.appName} Forum`;const v=await P(t.id),w=await Promise.all(v.map(async b=>{const T=await k(b.id);return{...b,...T}}));r(w)}else p(null),r([]);u(!1),d(!1)})()},[h]);const y=async s=>{if(s.preventDefault(),!n||!m.trim()||!x.trim())return;const t={...await D({categoryId:n.id,title:m,content:x,authorName:"Dr. Purab Sinha",authorTitle:"Lead Physiotherapist, DPT"}),replyCount:0,lastPost:null};r([t,...i]),d(!1),g(""),f("")},N=s=>{const a=Math.floor((new Date().getTime()-new Date(s).getTime())/1e3);let t=a/31536e3;return t>1?Math.floor(t)+" years ago":(t=a/2592e3,t>1?Math.floor(t)+" months ago":(t=a/86400,t>1?Math.floor(t)+" days ago":(t=a/3600,t>1?Math.floor(t)+" hours ago":(t=a/60,t>1?Math.floor(t)+" minutes ago":Math.floor(a)+" seconds ago"))))};return j?e.jsx("div",{className:"text-center py-24",children:e.jsx(F,{})}):n?e.jsx("section",{id:"category-page",className:"py-24 bg-slate-900 animate-fadeIn",children:e.jsxs("div",{className:"container mx-auto px-6 max-w-5xl",children:[e.jsxs("div",{className:"mb-8 text-sm text-slate-400",children:[e.jsx("button",{onClick:()=>o("/"),className:"hover:text-cyan-400",children:"Home"}),e.jsx("span",{className:"mx-2",children:">"}),e.jsx("button",{onClick:()=>o("/community"),className:"hover:text-cyan-400",children:"Community"})]}),e.jsxs("div",{className:"flex flex-col md:flex-row justify-between md:items-center mb-8",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl md:text-4xl font-bold",children:n.name}),e.jsx("p",{className:"text-slate-400 mt-1",children:n.description})]}),e.jsx("button",{onClick:()=>d(!c),className:"mt-4 md:mt-0 flex-shrink-0 bg-cyan-500 text-white px-5 py-2.5 rounded-lg hover:bg-cyan-400 transition-colors font-semibold",children:c?"Cancel":"Create New Topic"})]}),c&&e.jsx("div",{className:"bg-slate-800/50 p-6 rounded-xl border border-slate-700 mb-8 animate-fadeIn",children:e.jsxs("form",{onSubmit:y,className:"space-y-4",children:[e.jsx("h2",{className:"text-xl font-bold",children:"Create a new topic"}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"topic-title",className:"block text-slate-300 mb-1",children:"Topic Title"}),e.jsx("input",{id:"topic-title",type:"text",value:m,onChange:s=>g(s.target.value),required:!0,className:"w-full bg-slate-700 rounded-lg p-2 focus:ring-2 focus:ring-cyan-500 outline-none"})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"topic-content",className:"block text-slate-300 mb-1",children:"Content"}),e.jsx(M,{value:x,onChange:f})]}),e.jsx("button",{type:"submit",className:"bg-cyan-500 text-white px-4 py-2 rounded-lg hover:bg-cyan-400",children:"Submit Topic"})]})}),e.jsxs("div",{className:"bg-slate-800/50 rounded-xl border border-slate-700",children:[e.jsxs("div",{className:"hidden md:grid grid-cols-12 gap-4 p-4 border-b border-slate-700 text-slate-400 font-bold text-sm uppercase tracking-wider",children:[e.jsx("div",{className:"col-span-7",children:"Topic"}),e.jsx("div",{className:"col-span-1 text-center",children:"Replies"}),e.jsx("div",{className:"col-span-4",children:"Last Post"})]}),i.length>0?i.map(s=>e.jsxs("div",{className:"grid grid-cols-12 gap-x-4 gap-y-2 p-4 border-b border-slate-700 last:border-b-0 items-center hover:bg-slate-800 transition-colors",children:[e.jsxs("div",{className:"col-span-12 md:col-span-7",children:[e.jsx("button",{onClick:()=>o(`/community/${n.slug}/${s.id}`),className:"text-lg font-semibold text-cyan-400 hover:text-cyan-300 text-left leading-tight",children:s.title}),e.jsxs("p",{className:"text-xs text-slate-400 mt-1",children:["By ",s.authorName]})]}),e.jsxs("div",{className:"col-span-6 md:col-span-1 text-left md:text-center",children:[e.jsx("span",{className:"md:hidden text-xs text-slate-400 mr-2",children:"Replies:"}),e.jsx("span",{className:"font-bold text-lg",children:s.replyCount})]}),e.jsx("div",{className:"col-span-6 md:col-span-4 text-left md:text-left text-xs text-slate-400",children:s.lastPost?e.jsxs("div",{children:[e.jsxs("p",{className:"truncate",children:["by ",s.lastPost.authorName]}),e.jsx("p",{children:N(s.lastPost.createdAt)})]}):e.jsx("p",{children:"No replies yet"})})]},s.id)):e.jsxs("div",{className:"text-center py-12",children:[e.jsx("p",{className:"text-slate-300",children:"No topics in this category yet."}),e.jsx("p",{className:"text-slate-400 mt-2",children:"Be the first to start a discussion!"})]})]})]})}):e.jsx("div",{className:"text-center py-24 text-slate-400",children:"Category not found."})};export{$ as default};

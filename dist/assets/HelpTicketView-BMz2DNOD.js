import{r as l,j as e}from"./index-DIzydVhA.js";import{b as j,c as g}from"./helpCenterService-IPHEGUwt.js";import{L as N}from"./LoadingSpinner-BQulzYF6.js";const T=({ticketId:r,currentUser:a,onNavigate:p})=>{const[s,c]=l.useState(null),[h,b]=l.useState(!0),[o,d]=l.useState(""),[m,x]=l.useState(!1),f=async()=>{const n=(await j()).find(i=>i.id===r);n&&n.userId.toLowerCase()===a.username.toLowerCase()?c(n):c(null),b(!1)};l.useEffect(()=>{f()},[r,a.username]);const y=async t=>{if(t.preventDefault(),!o.trim()||!s)return;x(!0);const n=a.type.charAt(0).toUpperCase()+a.type.slice(1),i=await g(s.id,{authorName:a.username,authorType:n,message:o});i&&(c(i),d("")),x(!1)},u=t=>new Date(t).toLocaleString("en-US",{dateStyle:"medium",timeStyle:"short"});return h?e.jsx("div",{className:"text-center py-24",children:e.jsx(N,{})}):s?e.jsx("section",{className:"py-24 bg-slate-900 animate-fadeIn min-h-[80vh]",children:e.jsxs("div",{className:"container mx-auto px-6 max-w-3xl",children:[e.jsx("button",{onClick:()=>p("/help"),className:"mb-8 text-cyan-400 hover:text-cyan-300 font-semibold",children:"â† Back to Help Center"}),e.jsxs("header",{className:"mb-8",children:[e.jsx("h1",{className:"text-3xl font-bold",children:s.subject}),e.jsxs("p",{className:"text-slate-400 mt-1",children:["Status: ",s.status]})]}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"bg-slate-800 p-6 rounded-xl border border-slate-700",children:[e.jsx("p",{className:"font-semibold text-cyan-400",children:s.userId}),e.jsx("p",{className:"text-xs text-slate-400 mb-4",children:u(s.createdAt)}),e.jsx("p",{className:"text-slate-200 whitespace-pre-wrap",children:s.message})]}),s.replies.map(t=>e.jsxs("div",{className:`${t.authorType==="Admin"?"bg-cyan-900/50 border-cyan-800":"bg-slate-800 border-slate-700"} p-6 rounded-xl border`,children:[e.jsx("p",{className:`font-semibold ${t.authorType==="Admin"?"text-cyan-300":"text-cyan-400"}`,children:t.authorName}),e.jsx("p",{className:"text-xs text-slate-400 mb-4",children:u(t.createdAt)}),e.jsx("p",{className:"text-slate-200 whitespace-pre-wrap",children:t.message})]},t.id))]}),s.status!=="Closed"&&e.jsxs("div",{className:"mt-12 pt-8 border-t border-slate-700",children:[e.jsx("h2",{className:"text-2xl font-bold mb-4",children:"Post a Reply"}),e.jsxs("form",{onSubmit:y,className:"space-y-4",children:[e.jsx("textarea",{value:o,onChange:t=>d(t.target.value),rows:5,required:!0,className:"w-full bg-slate-700 rounded-lg p-3 focus:ring-2 focus:ring-cyan-500 outline-none"}),e.jsx("button",{type:"submit",disabled:m,className:"bg-cyan-500 text-white px-5 py-2.5 rounded-lg hover:bg-cyan-400 font-semibold disabled:bg-slate-600",children:m?"Submitting...":"Submit Reply"})]})]})]})}):e.jsx("div",{className:"text-center py-24 text-slate-400",children:"Ticket not found or you do not have permission to view it."})};export{T as default};
